!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define(["react"],e):t.ReactParade=e(t.React)}(this,function(t){"use strict";var e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},o={circle:{propertyX:"cx",propertyY:"cy"},ellipse:{propertyX:"cx",propertyY:"cy"},rect:{propertyX:"x",propertyY:"y"},image:{propertyX:"x",propertyY:"y"}},i=Object.keys(o),a=function(){function t(n){var r=n.element,i=n.totalLength,a=n.getPointAtLength,s=n.position;e(this,t);var u=o[r.nodeName],c=u.propertyX,p=u.propertyY;this.baseValX=r[c].baseVal,this.baseValY=r[p].baseVal,this.totalLength=i,this.getPointAtLength=a,this.position=s,this.reflectPosition()}return n(t,[{key:"marching",value:function(t){this.advancePosition(t),this.reflectPosition()}},{key:"advancePosition",value:function(t){var e=this.position+t;this.position=e<this.totalLength?e:e-this.totalLength}},{key:"reflectPosition",value:function(){var t=this.getPointAtLength(this.position),e=t.x,n=t.y;this.baseValX.value=e,this.baseValY.value=n}}]),t}(),s=function(t){var e=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","path");return e.setAttribute("d",t),e}(t);return{totalLength:e.getTotalLength(),getPointAtLength:function(t){return e.getPointAtLength(t)}}},u=function(t,e){return Array.from(t.querySelectorAll(e))},c=function(o){function c(){return e(this,c),r(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(c,t.Component),n(c,[{key:"componentWillMount",value:function(){var t=this;this.throwInvalidProps(this.props),this.parade=new Set,this.requestId=void 0,this.animation=function(){var e=t.props.pace;t.parade.forEach(function(t){return t.marching(e)}),t.request()},this.ref=function(t){t?this.getElements=function(){var e=[];return i.forEach(function(n){return u(t,n).forEach(function(t){return e.push(t)})}),e}:delete this.getElements}.bind(this)}},{key:"render",value:function(){return t.createElement("g",{ref:this.ref},this.props.children)}},{key:"componentDidMount",value:function(){this.organize(),this.canStart()&&this.start()}},{key:"organize",value:function(){var t=this;this.parade.clear();var e=s(this.props.d),n=e.totalLength,r=e.getPointAtLength;this.getElements().forEach(function(e,o,i){var s=i.length;return t.parade.add(new a({element:e,totalLength:n,getPointAtLength:r,position:n*(o/s)}))})}},{key:"request",value:function(){this.requestId=function(t){return window.requestAnimationFrame(t)}(this.animation)}},{key:"start",value:function(){this.request()}},{key:"cancel",value:function(){!function(t){window.cancelAnimationFrame(t)}(this.requestId),this.requestId=void 0}},{key:"canStart",value:function(){return!this.props.pause&&!this.requestId}},{key:"canCancel",value:function(){return this.props.pause}},{key:"componentWillReceiveProps",value:function(t){this.throwInvalidProps(t)}},{key:"componentDidUpdate",value:function(t){t.d!==this.props.d&&(this.cancel(),this.organize()),this.canStart()?this.start():this.canCancel()&&this.cancel()}},{key:"componentWillUnmount",value:function(){this.cancel(),this.parade.clear(),delete this.parade,delete this.animation,delete this.ref}},{key:"throwInvalidProps",value:function(t){if(!t.d||!function(t){return"string"==typeof t}(t.d))throw new Error("react-parade component requires props.d");if(!function(t){return"number"==typeof t}(t.pace))throw new TypeError('react-parade component props.pace must be "number"')}}]),c}();return c.defaultProps={pace:1},c});
